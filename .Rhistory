library(readr)
diabetes <- read_csv("C:/Users/Abhay Goyal/Downloads/diabetes.csv")
View(diabetes)
dim(diabetes)
library(ggplot2)
library(dplyr)
library(gridExtra)
library(corrplot)
str(diabetes)
head(diabetes)
?cat
cat("Number of missing values", sum(is.na(diabetes)), "\n")
summary(diabetes)
?hist
hist(diabetes$Pregnancies)
..count..
count(diaba)
count(diabetes$Pregnancies)
?count
ggplot(diabetes, aes(x=Pregnancies)) + ggtitle("Number of times pregnant") +
geom_histogram(aes(y = 100*(..count..)/sum(..count..)), binwidth = 1, colour="black", fill="white") + ylab("Percentage")
hist(diabetes$Pregnancies)
ggplot(diabetes, aes(x=Pregnancies)) + ggtitle("Number of times pregnant") +
geom_histogram(aes(y = 100*(..count..)/sum(..count..)), binwidth = 1, colour="black", fill="white") + ylab("Percentage")
ggplot(diabetes, aes(x=Pregnancies)) + ggtitle("Number of times pregnant") +
geom_histogram(aes(y = 100*(..count..)/sum(..count..)), binwidth = 2, colour="black", fill="white") + ylab("Percentage")
ggplot(diabetes, aes(x=Pregnancies)) + ggtitle("Number of times pregnant") +
geom_histogram(aes(y = 100*(..count..)/sum(..count..)), binwidth = 1, colour="black", fill="white") + ylab("Percentage")
diabetes$Pregnancies
ggplot(diabetes, aes(x=Pregnancies)) + ggtitle("Number of times pregnant") +
geom_histogram(aes(y = 100*(..count..)/sum(..count..)), binwidth = 1, colour="black", fill="white") + ylab("Percentage")
str(diabetes$Pregnancies)
sum(diabetes$Pregnancies)
sum(diabetes$Pregnancies)*100
(diabetes$Pregnancies)*100/sum(diabetes$Pregnancies)
(diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 10
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 10)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) > 15)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) > 13)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) > 10)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) > 5)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) < 0)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 0)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 5)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) => 5)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) >= 10)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) =< 15)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 15)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 15 and (diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) >=10)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 15 && (diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) >=10)
sum((diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) <= 15 && (diabetes$Pregnancies)*100/sum(diabetes$Pregnancies) >=12)
(diabetes$Pregnancies)*100/sum(diabetes$Pregnancies)
hist(diabetes$Pregnancies)
plot1 <- gpglot(diabetes, aes(x=Pregnancies))+ ggtitle("Number of times pregnant") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot1 <- ggplot(diabetes, aes(x=Pregnancies))+ ggtitle("Number of times pregnant") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot1
plot2 <- ggplot(diabetes, aes(x=Glucose))+ ggtitle("Glucose") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 5, colour = "black", fill= "white") + ylab("Percentage")
plot2
plot2 <- ggplot(diabetes, aes(x=Glucose))+ ggtitle("Glucose") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 5, colour = "black", fill= "white") + ylab("Percentage") + geom_line()
plot2
plot2 <- ggplot(diabetes, aes(x=Glucose))+ ggtitle("Glucose") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 5, colour = "black", fill= "white") + ylab("Percentage")
plot2
plot2 <- ggplot(diabetes, aes(x=Glucose))+ ggtitle("Glucose") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot2
plot2 <- ggplot(diabetes, aes(x=Glucose))+ ggtitle("Glucose") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 5, colour = "black", fill= "white") + ylab("Percentage")
plot2
plot3 <- ggplot(diabetes, aes(x=BloodPressure))+ ggtitle("Blood Pressure") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 5, colour = "black", fill= "white") + ylab("Percentage")
plot3
plot3 <- ggplot(diabetes, aes(x=BloodPressure))+ ggtitle("Blood Pressure") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 2, colour = "black", fill= "white") + ylab("Percentage")
plot3
plot4 <- ggplot(diabetes, aes(x=SkinThickness))+ ggtitle("Skin Thickness") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 2, colour = "black", fill= "white") + ylab("Percentage")
plot4
plot4 <- ggplot(diabetes, aes(x=Insulin))+ ggtitle("Insulin") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 20, colour = "black", fill= "white") + ylab("Percentage")
plot4 <- ggplot(diabetes, aes(x=SkinThickness))+ ggtitle("Skin Thickness") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 2, colour = "black", fill= "white") + ylab("Percentage")
plot4
plot5 <- ggplot(diabetes, aes(x=Insulin))+ ggtitle("Insulin") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 20, colour = "black", fill= "white") + ylab("Percentage")
plot5
plot6 <- ggplot(diabetes, aes(x=BMI))+ ggtitle("Body Mass Index") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot6
plot7 <- ggplot(diabetes, aes(x=DiabetesPedigreeFunction))+ ggtitle("Diabetes Pedigree Function") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), colour = "black", fill= "white") + ylab("Percentage")
plot7
plot7 <- ggplot(diabetes, aes(x=DiabetesPedigreeFunction))+ ggtitle("Diabetes Pedigree Function") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)),binwidth=1, colour = "black", fill= "white") + ylab("Percentage")
plot7
plot7 <- ggplot(diabetes, aes(x=DiabetesPedigreeFunction))+ ggtitle("Diabetes Pedigree Function") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)),binwidth = .1, colour = "black", fill= "white") + ylab("Percentage")
plot7
plot7 <- ggplot(diabetes, aes(x=DiabetesPedigreeFunction))+ ggtitle("Diabetes Pedigree Function") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)),binwidth = .01, colour = "black", fill= "white") + ylab("Percentage")
plot7
plot7 <- ggplot(diabetes, aes(x=DiabetesPedigreeFunction))+ ggtitle("Diabetes Pedigree Function") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), colour = "black", fill= "white") + ylab("Percentage")
plot7
summary(diabetes$DiabetesPedigreeFunction)
plot6
plot6 <- ggplot(diabetes, aes(x=BMI))+ ggtitle("Body Mass Index") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), colour = "black", fill= "white") + ylab("Percentage")
plot6
plot6 <- ggplot(diabetes, aes(x=BMI))+ ggtitle("Body Mass Index") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot6
plot7
plot8 <- ggplot(diabetes, aes(x=Age))+ ggtitle("Age") + geom_histogram(aes(y= 100*(..count..)/sum(..count..)), binwidth = 1, colour = "black", fill= "white") + ylab("Percentage")
plot8
modeltree <- rpart(Outcome ~ Age + Sex + Pregnancies + Glucose + BMI, method="class", data=train)
train(1:540,)
train <- diabetes
train <- diabetes[1:540,]
test <- diabetes[541:768,]
modeltree <- rpart(Outcome ~ Age + Sex + Pregnancies + Glucose + BMI, method="class", data=train)
library(rpart)
library(rpart.plot)
modeltree <- rpart(Outcome ~ Age + Sex + Pregnancies + Glucose + BMI, method="class", data=train)
modeltree <- rpart(Outcome ~ Age + SkinThickness + Pregnancies + Glucose + BMI, method="class", data=train)
rpart.plot(modeltree)
treepred <- predict(modeltree, test, type='class')
table(treepred, test$Outcome)
modeltree <- rpart(Outcome ~ Age + SkinThickness + Pregnancies + Glucose + BMI + Insulin + BloodPressure + DiabetesPedigreeFunction, method="class", data=train)
rpart.plot(modeltree)
treepred <- predict(modeltree, test, type='class')
table(treepred, test$Outcome)
mean(treepred==test$Outcome)
numeric.var <- sapply(diabetes, is.numeric)
numeric.var
corr.matrix <- cor(diabetes[,numeric.var])
corr.matrix
corrplot(corr.matrix)
?corrplot
install.packages("corrplot")
library(corrplot)
?corrplot
corrplot(corr.matrix)
corrplot(corr.matrix, order= hclustm t1.col="black" ,t1.sqrt=45,t1.cex=0.5, c1.cex=0.5)
corrplot(corr.matrix, order= hclust t1.col="black" ,t1.sqrt=45,t1.cex=0.5, c1.cex=0.5)
corrplot(corr.matrix, order= hclust, t1.col="black" ,t1.sqrt=45,t1.cex=0.5, c1.cex=0.5)
corrplot(corr.matrix,main="sfg", order= hclust, t1.col="black" ,t1.sqrt=45,t1.cex=0.5, c1.cex=0.5)
?corrplot
attach(diabetes)
boxplot(Pregnancies ~ Outcome, xlab="Outcome" , ylab="Pregnancies")
boxplot(Glucose ~ Outcome, xlab="Outcome" , ylab="Pregnancies")
boxplot(Glucose ~ Outcome, xlab="Outcome" , ylab="Glucose")
boxplot(BloodPressure ~ Outcome, xlab="Outcome" , ylab="Blood Pressure")
boxplot(Glucose ~ Outcome, xlab="Outcome" , ylab="Glucose")
boxplot(SkinThickness ~ Outcome, xlab="Outcome" , ylab="Skin Thickness")
boxplot(Insulin ~ Outcome, xlab="Outcome" , ylab="Skin Thickness")
boxplot(Insulin ~ Outcome, xlab="Outcome" , ylab="Insulin")
boxplot(BMI ~ Outcome, xlab="Outcome" , ylab="BMI")
which(diabetes$BMI == 0)
diabetes1 <- data.frame(diabetes)
diabetes1 <- diabetes1[-which(diabetes1$BMI == 0)]
which(diabetes$BloodPressure == 0)
diabetes1 <- diabetes1[-which(diabetes1$BloodPressure == 0)]
dim(diabetes1)
dim(diabetes)
diabetes2 <- data.frame(diabetes)
dim(diabetes)
diabetes2 <- apply(diabetes2, 1, function(diabetes2$BloodPressure) any(diabetes2$BloodPressure != 0))
which(diabetes2$BloodPressure)
as.factor(diabetes2$BloodPressure)
as.factor(diabetes2$BloodPressure)
which(diabetes2$BloodPressure)
which(diabetes2$BloodPressure)
(diabetes2$BloodPressure)
which(diabetes2$BloodPressure == 0)
?remove
rm(list = ls(8,  16 , 50 , 61,  79,  82, 173 ,194))
remo <- c(8  ,16  ,50 , 61 , 79 , 82, 173, 194)
rm(list = remo)
boxplot(Insulin ~ Outcome, xlab="Insulin" , ylab = "Outcome")
boxplot(BMI ~ Outcome, xlab="BMI" , ylab = "Outcome")
boxplot(DiabetesPedigreeFunction ~ Outcome, xlab="Diabetes Pedigree Function", ylab="Outcome")
attach(diabetes)
boxplot(DiabetesPedigreeFunction ~ Outcome, xlab="Diabetes Pedigree Function", ylab="Outcome")
boxplot(Age ~ Outcome, xlab="Outcome", ylab="Age")
diabetes$BloodPressure <- NULL
diabetes$SkinThickness <- NULL
train <- diabetes[1:540,]
test <- diabetes[541:768,]
model <- glm(Outcome ~., family)
model <- glm(Outcome ~., family = binomial(link='logit'), data=train
)
summary(model)
plot(model)
fitted.results <- predict(model, newdata = test, type='response')
fitted.results <- ifelse(fitted.results > 0.5,1,0)
misClasificError <- mean(fitted.results != test$Outcome)
print(paste('Accuracy', 1-misClasificError))
library(rpart)
model2 <- rpart(Outcome ~ Pregnancies + Glucose + Insulin + Age + BMI , data=train, method="class")
plot(model2)
text(model2)
text(model2 , cex=.8)
text(model2 , use.n =TRUE, cex=.8)
text(model2 , all =TRUE, cex=.8)
text(model2 , all =TRUE)
text(model2)
text(model2)
plot(model2)
text(model2)
treePred <- predict(model2, test, type='class'
)
table
table(treePred , diabetes$Outcome)
table(treePred , test$Outcome)
mean(treePred == test$Outcome)
